<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title>
    Google Visualization API Sample
  </title>

  <script type="text/javascript"
    src="https://www.gstatic.com/charts/loader.js"></script>

    <script type="text/javascript" src="tablequerywrapper.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {packages: ['charteditor']});
  </script>
  <script type="text/javascript">

 google.charts.load('current', {'packages' : ['table']});
    google.charts.setOnLoadCallback(init);

    var dataSourceUrl = 'https://docs.google.com/spreadsheets/d/1iAxLuHnkoBDEOjNfC9vbbsxltdcthQuJuGWee_jhO7U/edit?usp=sharing';
    var query, options, container;

    function init() {
      query = new google.visualization.Query(dataSourceUrl);
      container = document.getElementById("table");
      options = {'pageSize': 5};
      sendAndDraw();
    }

    function sendAndDraw() {
      query.abort();
      var tableQueryWrapper = new TableQueryWrapper(query, container, options);
      tableQueryWrapper.sendAndDraw();
    }


    function setOption(prop, value) {
      options[prop] = value;
      sendAndDraw();
    }




//GRAPH








google.charts.load('current');
  google.charts.setOnLoadCallback(drawVisualization);
  // google.charts.setOnLoadCallback(drawVisualization2);








  function drawVisualization() {


var sel = document.getElementById("choose");
var text= sel.options[sel.selectedIndex].value;
var newQuery,title;

  if (text === 'visualization'){
  newQuery = 'SELECT B,E WHERE E > 0';
  title = 'BDO CTarget' ;
} else{

  newQuery = 'SELECT B,D WHERE D > 0';
  title = 'BDO PTarget' ;

}


    var wrap = new google.visualization.ChartWrapper({
       'chartType':'ColumnChart',
       'dataSourceUrl':'https://docs.google.com/spreadsheets/d/1iAxLuHnkoBDEOjNfC9vbbsxltdcthQuJuGWee_jhO7U/edit?usp=sharing',
       'containerId':'visualization',
       'query': newQuery,
       'options': {'title':'BDO CTARGET', 'legend':'Q'}
       });
     wrap.draw();
  }



      

  </script>
</head>
<body>
<p>BDO SAMPLE GRAPH <br />


<form action="">
  Page:
  <select onChange="setOption('pageSize', parseInt(this.value, 10))">
    <option value="0">0</option>
    <option value="3">3</option>
    <option selected=selected value="5">5</option>
    <option value="8">8</option>
    <option value="-1">-1</option>
  </select>
</form>
</div>
<br />
<div id="table"></div>

<p>Chosse graph to display </p>
 <div style="display:block;"> 
<select id ="choose" onchange="drawVisualization(this)">
<option  value="none" ></option>
    <option  value="visualization" >CTarget</option>
    <option  value="visualization2" >PTarget</option>
</select>

<!-- <button onclick="myFunction()">Try it</button> -->
<div style="width: 100%; overflow: hidden;">
<div id="visualization" class ="graph" style="height: 400px; width: 600px;float: left;"></div>


<!-- <div id="visualization2" class ="graph" style="height: 400px; width: 600px;margin-left: 620px;"></div> -->

</div>
</body>
</html>