<!DOCTYPE html>
<html>
<head>
<title>BDO</title>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript" src="tablequerywrapper.js"></script>
<script type="text/javascript">
    google.charts.load('current', {'packages' : ['table']});
    google.charts.setOnLoadCallback(init);

    var dataSourceUrl = 'https://docs.google.com/spreadsheets/d/1iAxLuHnkoBDEOjNfC9vbbsxltdcthQuJuGWee_jhO7U/edit?usp=sharing';
    var query, options, container;

    function init() {
      query = new google.visualization.Query(dataSourceUrl);
      container = document.getElementById("table");
      options = {'pageSize': 5};
      sendAndDraw();
    }

    function sendAndDraw() {
      query.abort();
      var tableQueryWrapper = new TableQueryWrapper(query, container, options);
      tableQueryWrapper.sendAndDraw();
    }


    function setOption(prop, value) {
      options[prop] = value;
      sendAndDraw();
    }


 // google.charts.load('current');
 //  google.charts.setOnLoadCallback(drawVisualization);

 //  function drawVisualization() {
 //    var wrap = new google.visualization.ChartWrapper({
 //       'chartType':'ColumnChart',
 //       'dataSourceUrl':'https://docs.google.com/spreadsheets/d/1iAxLuHnkoBDEOjNfC9vbbsxltdcthQuJuGWee_jhO7U/edit?usp=sharing',
 //       'containerId':'visualization',
 //       'query':'SELECT B,D WHERE D > 0 ORDER BY D',
 //       'options': {'title':'BDO CHART', 'legend':'Ptarget'}
 //       });
 //     wrap.draw();
 //  }
  </script>
</head>
<body>
<p>This example uses the following spreadsheet: <br />

</p>

<form action="">
  Number of rows to show:
  <select onChange="setOption('pageSize', parseInt(this.value, 10))">
    <option value="0">0</option>
    <option value="3">3</option>
    <option selected=selected value="5">5</option>
    <option value="8">8</option>
    <option value="-1">-1</option>
  </select>
</form>
<br />
<div id="table"></div>

  <div id="visualization" style="height: 400px; width: 800px;"></div>
</body>
</html>